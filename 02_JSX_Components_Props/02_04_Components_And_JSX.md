# Компоненты и Синтаксис JSX

В предыдущей главе вы создали свой первый компонент. Теперь мы углубимся в тему и поговорим о том, как создавать компоненты и использовать синтаксис JSX.

## Что такое JSX?

**JSX (JavaScript XML)** — это расширение языка JavaScript, которое позволяет писать HTML-подобный код внутри JavaScript. Оно используется для описания пользовательских интерфейсов React. JSX облегчает работу с DOM-элементами, делая код более выразительным и удобным для чтения [^1].

**Пример 1.** _Разметка в JSX_

```jsx
function App() {
  return (
    <div>
      <h1>Hello, React!</h1>
    </div>
  );
}
```

## Как работает JSX?

JSX позволяет создавать структуры DOM, которые затем преобразуются React в обычные JavaScript-объекты (React-элементы). Эти объекты используются для управления DOM.

> [!NOTE]
> Под капотом JSX превращается в вызовы функций React.createElement, что делает его совместимым с JavaScript.

**Пример 2.** _Преобразование JSX в JavaScript_

```jsx
const element = <h1>Hello, React!</h1>;
```

Транслируется в:

```js
const element = React.createElement("h1", null, "Hello, React!");
```

Простыми словами вы можете совмещать JavaScript и HTML в одном файле, что делает код более читаемым и удобным для работы.

### Преимущества JSX

- **Читаемость кода**. Благодаря схожести с HTML, JSX делает код более интуитивно понятным.
- **Интеграция с JavaScript**. Вы можете использовать JavaScript-выражения прямо внутри JSX.
- **Оптимизация производительности**. React использует виртуальный DOM, чтобы минимизировать изменения в реальном DOM.
- **Безопасность**. JSX автоматически экранирует значения для предотвращения инъекций кода (XSS).

### Использование JSX

Рассмотрим пример, где HTML и JavaScript разделены:

```html
<!-- index.html -->
<!-- index.html -->
<div>
  <p>
    <!-- Content -->
  </p>
  <form>
    <!-- Form -->
  </form>
</div>
```

```js
function onClick() {}
function onSubmit() {}
function changeContent() {}
```

В React вы можете объединить разметку и логику в одном месте:

```jsx
Form() {
    onClick() { }
    onSubmit() { }

    return (
        <div>
        <p onClick>
            <!-- Content -->
        </p>
        <form onSubmit>
            <!-- Form -->
        </form>
        </div>
    );
}
```

## Правила использования JSX

JSX имеет свои правила и ограничения, которые важно понимать для успешной разработки React-приложений [^1].

### 1. Все элементы JSX должны быть обернуты в один корневой элемент

JSX всегда должен возвращать единственный корневой элемент. Например, следующий код приведет к ошибке:

```jsx
function App() {
  return (
    <h1>Hello, React!</h1>
    <p>Welcome to the world of React!</p>
  );
}
```

Для исправления ошибки необходимо обернуть элементы в один общий элемент.

```jsx
function App() {
  return (
    <div>
      <h1>Hello, React!</h1>
      <p>Welcome to the world of React!</p>
    </div>
  );
}
```

Если создание дополнительного элемента нежелательно, можно использовать фрагменты (`<>`), которые часто называются "пустыми тегами".

```jsx
function App() {
  return (
    <>
      <h1>Hello, React!</h1>
      <p>Welcome to the world of React!</p>
    </>
  );
}
```

При использовании фрагментов не создается дополнительный элемент в DOM, что позволяет сохранить структуру разметки.

> [!TIP]
> Используйте фрагменты, чтобы избежать создания лишних DOM-узлов.

### 2. Все элементы JSX должны быть закрыты

В JSX все элементы должны быть закрыты, даже если они не содержат вложенных элементов.

Например, следующий код вызовет предупреждение:

```jsx
function App() {
  return (
    <input type="text">
  );
}
```

Хоть данный элемент и однострочный, его нужно закрыть с помощью `/`.

```jsx
function App() {
  return <input type="text" />;
}
```

### 3. Использование camelCase для атрибутов

JSX использует camelCase для именования атрибутов, чтобы согласовывать их с JavaScript-стилем написания. **Например**:

- Вместо `class` используется `className`.
- Вместо `onclick` используется `onClick`.
- Вместо `tabindex` используется `tabIndex`.

**Пример 3.** _Использование camelCase для атрибутов_

```jsx
function App() {
  return (
    <button className="btn" tabIndex="1">
      Click me
    </button>
  );
}
```

> [!NOTE]
> Исключение составляют специальные атрибуты, такие как `aria-*` и `data-*`, которые пишутся без изменений.

## Использование JavaScript внутри JSX

JSX позволяет использовать JavaScript-выражения внутри фигурных скобок `{}`. В фигурных скобках можно использовать только выражения, а не инструкции.

**Пример 4.** _Использование переменной в JSX_

```jsx
function App() {
  const name = "React";
  return <h1>Hello, {name}!</h1>;
}
```

**Пример 5.** _Использование функции в JSX_

```jsx
function App() {
  const greet = (name) => `Hello, ${name}!`;

  return <h1>{greet("React")}</h1>;
}
```

**Пример 6.** _Использование выражения в JSX_

```jsx
function App() {
  return <h1>2 + 2 = {2 + 2}</h1>;
}
```

## Ограничения в JSX

JSX не поддерживает использование инструкций, таких как `if`, `for`, или `while`.

**Пример 7.** _Неверное использование инструкции в JSX_

```jsx
function App() {
  const isReact = true;

  return (
    if (isReact) {
      <h1>Hello, React!</h1>;
    }
  );
}
```

Для решения этой проблемы используйте тернарный оператор или логическое ИЛИ.

**Пример 8.** _Использование тернарного оператора в JSX_

```jsx
function App() {
  const isReact = true;

  return (
    <div>
      <p>{isReact ? <h1>Hello, React!</h1> : <h1>Welcome!</h1>}</p>
    </div>
  );
}
```

[^1]: _Writing Markup with JSX_. react.dev [online resource]. Available at: https://react.dev/learn/writing-markup-with-jsx

## Создание компонентов в React

В React компоненты являются строительными блоками пользовательских интерфейсов.

Существует два основных способа их создания: **классовые** и **функциональные** компоненты.

### Классовые компоненты

**Классовые компоненты** — это традиционный способ создания компонентов в React. Они являются классами ES6, которые наследуются от `React.Component.`

Однако функциональные компоненты заменили классовые как более простой и предпочтительный способ создания компонентов.

**Пример 1.** _Классовый компонент_

```jsx
import React from "react";

class MyComponent extends React.Component {
  render() {
    return <h1>Hello, React!</h1>;
  }
}

export default MyComponent;
```

**Особенности**:

- Должны наследоваться от `React.Component`.
- Используют метод render для возврата `JSX-разметки`.

> [!WARNING]
> Классовые компоненты считаются устаревшими. Новым проектам рекомендуется использовать функциональные компоненты.

### Функциональные компоненты

**Функциональные компоненты** — это современный способ создания компонентов. Они представляют собой обычные функции, которые принимают входные данные (props) и возвращают JSX-разметку.

**Почему функциональные компоненты предпочтительны?**

- **Простота**. Они проще в написании и чтении.
- **Меньше кода**. Нет необходимости наследовать класс или использовать метод render.

**Пример 2.** _Функциональный компонент_

```jsx
function MyComponent() {
  return <h1>Hello, React!</h1>;
}

export default MyComponent;
```

### Где хранить компоненты?

В React-приложениях рекомендуется организовывать структуру файлов так, чтобы компоненты были легко доступны и логически сгруппированы.

Компоненты рекомендуется хранить в отдельной директории `components`, которая находится в директории `src`.

**Пример 3.** _Структура файлов проекта_

```
my-app/
├── src/
│   ├── components/
│   │   ├── Header.jsx
│   │   ├── Footer.jsx
│   ├── App.jsx
```

### Как создать компонент в React?

1. **Создайте новый файл.**
   - Название файла должно быть понятным, отражать назначение компонента и начинаться с заглавной буквы.
   - **Пример**: `Header.jsx`
2. **Создайте функцию для компонента.**

   - Функция должна возвращать JSX-разметку.
   - Имя функции должно совпадать с именем файла.

   ```jsx
   function Header() {
     return (
       <header>
         <h1>My React App</h1>
       </header>
     );
   }
   ```

3. **Экспортируйте компонент.**

   - Используйте `export default`, чтобы сделать компонент доступным для использования в других файлах.

   ```jsx
   function Header() {
     return (
       <header>
         <h1>My React App</h1>
       </header>
     );
   }

   export default Header;
   ```

4. **Импортируйте компонент**

   - Чтобы использовать компонент, выполните его импорт в нужном месте:

   ```jsx
   import Header from "./components/Header";

   function App() {
     return (
       <div>
         <Header />
       </div>
     );
   }

   export default App;
   ```

### Пример создания и использования компонентов

Создадим два функциональных компонента: `Header` и `Post`.

#### Компонент `Header`

Создайте файл `Header.jsx` в папке `components` со следующим содержимым:

```jsx
function Header() {
  return (
    <header>
      <h1>My React App</h1>
    </header>
  );
}

export default Header;
```

#### Компонент `Post`

Создайте файл `Post.jsx` в папке `components` со следующим содержимым:

```jsx
import Header from "./Header";

function Post() {
  return (
    <div>
      <Header />
      <p>Post information goes here.</p>
    </div>
  );
}

export default Post;
```

При рендеринге вместо компонента `Header` будет отображаться html-разметка из компонента `Header`.

#### Использование компонентов

Измените файл `App.jsx` следующим образом:

```jsx
import Post from "./components/Post";

function App() {
  return (
    <div>
      <Post />
    </div>
  );
}

export default App;
```

При переходе на страницу вы увидите заголовок `My React App`, а под ним информацию о профиле пользователя.

> [!NOTE]
> При использовании компонентов код становится более структурированным, повторно используемым и легко читаемым, что облегчает разработку и поддержку приложения.

Теперь можно проследить общую связь компонентов и их рендеринг.

<img src="https://i.imgur.com/zVqndFt.png" style="width: 100%; max-width: 800px;" />

> [!NOTE]
> **Рендеринг** - это процесс преобразования React-компонентов в DOM-элементы, которые отображаются в браузере.

### Дочерние и родительские компоненты в React

В React-приложениях компоненты организуются иерархически. Часто один компонент содержит другие компоненты, что приводит к их разделению на родительские и дочерние.

- **Дочерний компонент** — компонент, который находится внутри другого компонента.
- **Родительский компонент** — компонент, который содержит один или несколько дочерних компонентов.
- **Корневой компонент** — верхнеуровневый компонент, с которого начинается иерархия приложения. Обычно это `App`.

**Пример 4.** _Дочерний и родительский компонент_

```jsx
import Header from "./Header";

function Post() {
  return (
    <div>
      <Header />
      <p>Post information goes here.</p>
    </div>
  );
}
```

1. Компонент `Header`:
   - Находится внутри компонента `Post`.
   - Является **дочерним** компонентом для `Post`.
2. Компонент `Post`:
   - Содержит `Header`.
   - Является родительским компонентом для `Header`.
